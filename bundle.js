var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(n)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t){return null==t?"":t}function c(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function d(){return h(" ")}function g(){return h("")}function v(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t){return function(e){return e.preventDefault(),t.call(this,e)}}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function S(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}let k;function T(t){k=t}function C(){if(!k)throw new Error("Function called outside component initialization");return k}function L(){const t=C();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);r.slice().forEach(e=>{e.call(t,o)})}}}const E=[],_=[],x=[],P=[],H=Promise.resolve();let I=!1;function A(t){x.push(t)}let M=!1;const O=new Set;function j(){if(!M){M=!0;do{for(let t=0;t<E.length;t+=1){const e=E[t];T(e),$(e.$$)}for(E.length=0;_.length;)_.pop()();for(let t=0;t<x.length;t+=1){const e=x[t];O.has(e)||(O.add(e),e())}x.length=0}while(E.length);for(;P.length;)P.pop()();I=!1,M=!1,O.clear()}}function $(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const R=new Set;let F;function N(){F={r:0,c:[],p:F}}function D(){F.r||o(F.c),F=F.p}function q(t,e){t&&t.i&&(R.delete(t),t.i(e))}function U(t,e,n,r){if(t&&t.o){if(R.has(t))return;R.add(t),F.c.push(()=>{R.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}const W="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function B(t){t&&t.c()}function J(t,e,r){const{fragment:s,on_mount:a,on_destroy:c,after_update:u}=t.$$;s&&s.m(e,r),A(()=>{const e=a.map(n).filter(i);c?c.push(...e):o(e),t.$$.on_mount=[]}),u.forEach(A)}function z(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function K(t,e){-1===t.$$.dirty[0]&&(E.push(t),I||(I=!0,H.then(j)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,n,i,s,a,c,u=[-1]){const p=k;T(e);const f=n.props||{},h=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:[]),callbacks:r(),dirty:u,skip_bound:!1};let d=!1;if(h.ctx=i?i(e,f,(t,n,...r)=>{const o=r.length?r[0]:n;return h.ctx&&a(h.ctx[t],h.ctx[t]=o)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](o),d&&K(e,t)),n}):[],h.update(),d=!0,o(h.before_update),h.fragment=!!s&&s(h.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);h.fragment&&h.fragment.l(t),t.forEach(l)}else h.fragment&&h.fragment.c();n.intro&&q(e.$$.fragment),J(e,n.target,n.anchor),j()}T(p)}class G{$destroy(){z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function V(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}var Y,Q,Z=(function(t,e){var n;window,n=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n.r(e),n(1);var r=n(3);n.d(e,"VERSION",(function(){return r.VERSION})),n.d(e,"AbortError",(function(){return r.AbortError})),n.d(e,"HttpError",(function(){return r.HttpError})),n.d(e,"TimeoutError",(function(){return r.TimeoutError})),n.d(e,"HttpClient",(function(){return r.HttpClient})),n.d(e,"HttpResponse",(function(){return r.HttpResponse})),n.d(e,"DefaultHttpClient",(function(){return r.DefaultHttpClient})),n.d(e,"HubConnection",(function(){return r.HubConnection})),n.d(e,"HubConnectionState",(function(){return r.HubConnectionState})),n.d(e,"HubConnectionBuilder",(function(){return r.HubConnectionBuilder})),n.d(e,"MessageType",(function(){return r.MessageType})),n.d(e,"LogLevel",(function(){return r.LogLevel})),n.d(e,"HttpTransportType",(function(){return r.HttpTransportType})),n.d(e,"TransferFormat",(function(){return r.TransferFormat})),n.d(e,"NullLogger",(function(){return r.NullLogger})),n.d(e,"JsonHubProtocol",(function(){return r.JsonHubProtocol})),Uint8Array.prototype.indexOf||Object.defineProperty(Uint8Array.prototype,"indexOf",{value:Array.prototype.indexOf,writable:!0}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice,writable:!0}),Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach,writable:!0})},function(t,e,n){(function(e){var r;
/*!
     * @overview es6-promise - a tiny implementation of Promises/A+.
     * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
     * @license   Licensed under MIT license
     *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
     * @version   v4.2.2+97478eb6
     */r=function(){function t(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,s=void 0,a=function(t,e){d[o]=t,d[o+1]=e,2===(o+=2)&&(s?s(g):w())},c="undefined"!=typeof window?window:void 0,u=c||{},l=u.MutationObserver||u.WebKitMutationObserver,p="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var t=setTimeout;return function(){return t(g,1)}}var d=new Array(1e3);function g(){for(var t=0;t<o;t+=2)(0,d[t])(d[t+1]),d[t]=void 0,d[t+1]=void 0;o=0}var v,y,b,m,w=void 0;function S(t,e){var n=this,r=new this.constructor(C);void 0===r[T]&&F(r);var o=n._state;if(o){var i=arguments[o-1];a((function(){return $(o,r,i,n._result)}))}else A(n,r,t,e);return r}function k(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(C);return x(e,t),e}p?w=function(){return process.nextTick(g)}:l?(y=0,b=new l(g),m=document.createTextNode(""),b.observe(m,{characterData:!0}),w=function(){m.data=y=++y%2}):f?((v=new MessageChannel).port1.onmessage=g,w=function(){return v.port2.postMessage(0)}):w=void 0===c?function(){try{var t=n(!function(){var t=new Error("Cannot find module 'vertx'");throw t.code="MODULE_NOT_FOUND",t}());return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(g)}:h()}catch(t){return h()}}():h();var T=Math.random().toString(36).substring(16);function C(){}var L=new O;function E(t){try{return t.then}catch(t){return L.error=t,L}}function _(e,n,r){n.constructor===e.constructor&&r===S&&n.constructor.resolve===k?function(t,e){1===e._state?H(t,e._result):2===e._state?I(t,e._result):A(e,void 0,(function(e){return x(t,e)}),(function(e){return I(t,e)}))}(e,n):r===L?(I(e,L.error),L.error=null):void 0===r?H(e,n):t(r)?function(t,e,n){a((function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,(function(n){r||(r=!0,e!==n?x(t,n):H(t,n))}),(function(e){r||(r=!0,I(t,e))}),t._label);!r&&o&&(r=!0,I(t,o))}),t)}(e,n,r):H(e,n)}function x(t,e){var n,r;t===e?I(t,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=e),null===n||"object"!==r&&"function"!==r?H(t,e):_(t,e,E(e)))}function P(t){t._onerror&&t._onerror(t._result),M(t)}function H(t,e){void 0===t._state&&(t._result=e,t._state=1,0!==t._subscribers.length&&a(M,t))}function I(t,e){void 0===t._state&&(t._state=2,t._result=e,a(P,t))}function A(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+1]=n,o[i+2]=r,0===i&&t._state&&a(M,t)}function M(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?$(n,r,o,i):o(i);t._subscribers.length=0}}function O(){this.error=null}var j=new O;function $(e,n,r,o){var i=t(r),s=void 0,a=void 0,c=void 0,u=void 0;if(i){if((s=function(t,e){try{return t(e)}catch(t){return j.error=t,j}}(r,o))===j?(u=!0,a=s.error,s.error=null):c=!0,n===s)return void I(n,new TypeError("A promises callback cannot return that same promise."))}else s=o,c=!0;void 0!==n._state||(i&&c?x(n,s):u?I(n,a):1===e?H(n,s):2===e&&I(n,s))}var R=0;function F(t){t[T]=R++,t._state=void 0,t._result=void 0,t._subscribers=[]}var N=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(C),this.promise[T]||F(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?H(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&H(this.promise,this._result))):I(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;void 0===this._state&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===k){var o=E(t);if(o===S&&void 0!==t._state)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===D){var i=new n(C);_(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;void 0===r._state&&(this._remaining--,2===t?I(r,n):this._result[e]=n),0===this._remaining&&H(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;A(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},t}(),D=function(){function t(e){this[T]=R++,this._result=this._state=void 0,this._subscribers=[],C!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(t,e){try{e((function(e){x(t,e)}),(function(e){I(t,e)}))}catch(e){I(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){throw n}))}))},t}();return D.prototype.then=S,D.all=function(t){return new N(this,t).promise},D.race=function(t){var e=this;return r(t)?new e((function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))},D.resolve=k,D.reject=function(t){var e=new this(C);return I(e,t),e},D._setScheduler=function(t){s=t},D._setAsap=function(t){a=t},D._asap=a,D.polyfill=function(){var t=void 0;if(void 0!==e)t=e;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}t.Promise=D},D.Promise=D,D.polyfill(),D},t.exports=r()}).call(this,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){n.r(e),n.d(e,"VERSION",(function(){return h}));var r=n(4);n.d(e,"AbortError",(function(){return r.AbortError})),n.d(e,"HttpError",(function(){return r.HttpError})),n.d(e,"TimeoutError",(function(){return r.TimeoutError}));var o=n(5);n.d(e,"HttpClient",(function(){return o.HttpClient})),n.d(e,"HttpResponse",(function(){return o.HttpResponse}));var i=n(6);n.d(e,"DefaultHttpClient",(function(){return i.DefaultHttpClient}));var s=n(10);n.d(e,"HubConnection",(function(){return s.HubConnection})),n.d(e,"HubConnectionState",(function(){return s.HubConnectionState}));var a=n(16);n.d(e,"HubConnectionBuilder",(function(){return a.HubConnectionBuilder}));var c=n(15);n.d(e,"MessageType",(function(){return c.MessageType}));var u=n(9);n.d(e,"LogLevel",(function(){return u.LogLevel}));var l=n(18);n.d(e,"HttpTransportType",(function(){return l.HttpTransportType})),n.d(e,"TransferFormat",(function(){return l.TransferFormat}));var p=n(14);n.d(e,"NullLogger",(function(){return p.NullLogger}));var f=n(23);n.d(e,"JsonHubProtocol",(function(){return f.JsonHubProtocol}));var h="1.1.4"},function(t,e,n){n.r(e),n.d(e,"HttpError",(function(){return i})),n.d(e,"TimeoutError",(function(){return s})),n.d(e,"AbortError",(function(){return a}));var r,o=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=function(t){function e(e,n){var r=this,o=this.constructor.prototype;return(r=t.call(this,e)||this).statusCode=n,r.__proto__=o,r}return o(e,t),e}(Error),s=function(t){function e(e){void 0===e&&(e="A timeout occurred.");var n=this,r=this.constructor.prototype;return(n=t.call(this,e)||this).__proto__=r,n}return o(e,t),e}(Error),a=function(t){function e(e){void 0===e&&(e="An abort occurred.");var n=this,r=this.constructor.prototype;return(n=t.call(this,e)||this).__proto__=r,n}return o(e,t),e}(Error)},function(t,e,n){n.r(e),n.d(e,"HttpResponse",(function(){return o})),n.d(e,"HttpClient",(function(){return i}));var r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=function(t,e,n){this.statusCode=t,this.statusText=e,this.content=n},i=function(){function t(){}return t.prototype.get=function(t,e){return this.send(r({},e,{method:"GET",url:t}))},t.prototype.post=function(t,e){return this.send(r({},e,{method:"POST",url:t}))},t.prototype.delete=function(t,e){return this.send(r({},e,{method:"DELETE",url:t}))},t.prototype.getCookieString=function(t){return""},t}()},function(t,e,n){n.r(e),n.d(e,"DefaultHttpClient",(function(){return u}));var r,o=n(4),i=n(5),s=n(7),a=n(8),c=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(e){var n=t.call(this)||this;return"undefined"!=typeof XMLHttpRequest?n.httpClient=new a.XhrHttpClient(e):n.httpClient=new s.NodeHttpClient(e),n}return c(e,t),e.prototype.send=function(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new o.AbortError):t.method?t.url?this.httpClient.send(t):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},e.prototype.getCookieString=function(t){return this.httpClient.getCookieString(t)},e}(i.HttpClient)},function(t,e,n){n.r(e),n.d(e,"NodeHttpClient",(function(){return s}));var r,o=n(5),i=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e){return t.call(this)||this}return i(e,t),e.prototype.send=function(){return Promise.reject(new Error("If using Node either provide an XmlHttpRequest polyfill or consume the cjs or esm script instead of the browser/signalr.js one."))},e}(o.HttpClient)},function(t,e,n){n.r(e),n.d(e,"XhrHttpClient",(function(){return c}));var r,o=n(4),i=n(5),s=n(9),a=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e){var n=t.call(this)||this;return n.logger=e,n}return a(e,t),e.prototype.send=function(t){var e=this;return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new o.AbortError):t.method?t.url?new Promise((function(n,r){var a=new XMLHttpRequest;a.open(t.method,t.url,!0),a.withCredentials=!0,a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var c=t.headers;c&&Object.keys(c).forEach((function(t){a.setRequestHeader(t,c[t])})),t.responseType&&(a.responseType=t.responseType),t.abortSignal&&(t.abortSignal.onabort=function(){a.abort(),r(new o.AbortError)}),t.timeout&&(a.timeout=t.timeout),a.onload=function(){t.abortSignal&&(t.abortSignal.onabort=null),a.status>=200&&a.status<300?n(new i.HttpResponse(a.status,a.statusText,a.response||a.responseText)):r(new o.HttpError(a.statusText,a.status))},a.onerror=function(){e.logger.log(s.LogLevel.Warning,"Error from HTTP request. "+a.status+": "+a.statusText+"."),r(new o.HttpError(a.statusText,a.status))},a.ontimeout=function(){e.logger.log(s.LogLevel.Warning,"Timeout from HTTP request."),r(new o.TimeoutError)},a.send(t.content||"")})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},e}(i.HttpClient)},function(t,e,n){var r;n.r(e),n.d(e,"LogLevel",(function(){return r})),function(t){t[t.Trace=0]="Trace",t[t.Debug=1]="Debug",t[t.Information=2]="Information",t[t.Warning=3]="Warning",t[t.Error=4]="Error",t[t.Critical=5]="Critical",t[t.None=6]="None"}(r||(r={}))},function(t,e,n){n.r(e),n.d(e,"HubConnectionState",(function(){return r})),n.d(e,"HubConnection",(function(){return l}));var r,o=n(11),i=n(15),s=n(9),a=n(13),c=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(s,a)}c((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};!function(t){t[t.Disconnected=0]="Disconnected",t[t.Connected=1]="Connected"}(r||(r={}));var l=function(){function t(t,e,n){var s=this;a.Arg.isRequired(t,"connection"),a.Arg.isRequired(e,"logger"),a.Arg.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.logger=e,this.protocol=n,this.connection=t,this.handshakeProtocol=new o.HandshakeProtocol,this.connection.onreceive=function(t){return s.processIncomingData(t)},this.connection.onclose=function(t){return s.connectionClosed(t)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0,this.receivedHandshakeResponse=!1,this.connectionState=r.Disconnected,this.cachedPingMessage=this.protocol.writeMessage({type:i.MessageType.Ping})}return t.create=function(e,n,r){return new t(e,n,r)},Object.defineProperty(t.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),t.prototype.start=function(){return c(this,void 0,void 0,(function(){var t,e,n=this;return u(this,(function(o){switch(o.label){case 0:return t={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(s.LogLevel.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,e=new Promise((function(t,e){n.handshakeResolver=t,n.handshakeRejecter=e})),[4,this.connection.start(this.protocol.transferFormat)];case 1:return o.sent(),this.logger.log(s.LogLevel.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(t))];case 2:return o.sent(),this.logger.log(s.LogLevel.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,e];case 3:return o.sent(),this.connectionState=r.Connected,[2]}}))}))},t.prototype.stop=function(){return this.logger.log(s.LogLevel.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),this.connection.stop()},t.prototype.stream=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o,s=this.createStreamInvocation(t,n),c=new a.Subject;c.cancelCallback=function(){var t=e.createCancelInvocation(s.invocationId),n=e.protocol.writeMessage(t);return delete e.callbacks[s.invocationId],o.then((function(){return e.sendMessage(n)}))},this.callbacks[s.invocationId]=function(t,e){e?c.error(e):t&&(t.type===i.MessageType.Completion?t.error?c.error(new Error(t.error)):c.complete():c.next(t.item))};var u=this.protocol.writeMessage(s);return o=this.sendMessage(u).catch((function(t){c.error(t),delete e.callbacks[s.invocationId]})),c},t.prototype.sendMessage=function(t){return this.resetKeepAliveInterval(),this.connection.send(t)},t.prototype.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.createInvocation(t,e,!0),o=this.protocol.writeMessage(r);return this.sendMessage(o)},t.prototype.invoke=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.createInvocation(t,n,!1),s=new Promise((function(t,n){e.callbacks[o.invocationId]=function(e,r){r?n(r):e&&(e.type===i.MessageType.Completion?e.error?n(new Error(e.error)):t(e.result):n(new Error("Unexpected message type: "+e.type)))};var r=e.protocol.writeMessage(o);e.sendMessage(r).catch((function(t){n(t),delete e.callbacks[o.invocationId]}))}));return s},t.prototype.on=function(t,e){t&&e&&(t=t.toLowerCase(),this.methods[t]||(this.methods[t]=[]),-1===this.methods[t].indexOf(e)&&this.methods[t].push(e))},t.prototype.off=function(t,e){if(t){t=t.toLowerCase();var n=this.methods[t];if(n)if(e){var r=n.indexOf(e);-1!==r&&(n.splice(r,1),0===n.length&&delete this.methods[t])}else delete this.methods[t]}},t.prototype.onclose=function(t){t&&this.closedCallbacks.push(t)},t.prototype.processIncomingData=function(t){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(t=this.processHandshakeResponse(t),this.receivedHandshakeResponse=!0),t)for(var e=0,n=this.protocol.parseMessages(t,this.logger);e<n.length;e++){var r=n[e];switch(r.type){case i.MessageType.Invocation:this.invokeClientMethod(r);break;case i.MessageType.StreamItem:case i.MessageType.Completion:var o=this.callbacks[r.invocationId];null!=o&&(r.type===i.MessageType.Completion&&delete this.callbacks[r.invocationId],o(r));break;case i.MessageType.Ping:break;case i.MessageType.Close:this.logger.log(s.LogLevel.Information,"Close message received from server."),this.connection.stop(r.error?new Error("Server returned an error on close: "+r.error):void 0);break;default:this.logger.log(s.LogLevel.Warning,"Invalid message type: "+r.type+".")}}this.resetTimeoutPeriod()},t.prototype.processHandshakeResponse=function(t){var e,n,r;try{r=(e=this.handshakeProtocol.parseHandshakeResponse(t))[0],n=e[1]}catch(t){var o="Error parsing handshake response: "+t;this.logger.log(s.LogLevel.Error,o);var i=new Error(o);throw this.connection.stop(i),this.handshakeRejecter(i),i}if(n.error)throw o="Server returned handshake error: "+n.error,this.logger.log(s.LogLevel.Error,o),this.handshakeRejecter(o),this.connection.stop(new Error(o)),new Error(o);return this.logger.log(s.LogLevel.Debug,"Server handshake complete."),this.handshakeResolver(),r},t.prototype.resetKeepAliveInterval=function(){var t=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout((function(){return c(t,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:if(this.connectionState!==r.Connected)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return t.sent(),[3,4];case 3:return t.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}}))}))}),this.keepAliveIntervalInMilliseconds)},t.prototype.resetTimeoutPeriod=function(){var t=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout((function(){return t.serverTimeout()}),this.serverTimeoutInMilliseconds))},t.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},t.prototype.invokeClientMethod=function(t){var e=this,n=this.methods[t.target.toLowerCase()];if(n){if(n.forEach((function(n){return n.apply(e,t.arguments)})),t.invocationId){var r="Server requested a response, which is not supported in this version of the client.";this.logger.log(s.LogLevel.Error,r),this.connection.stop(new Error(r))}}else this.logger.log(s.LogLevel.Warning,"No client method with the name '"+t.target+"' found.")},t.prototype.connectionClosed=function(t){var e=this,n=this.callbacks;this.callbacks={},this.connectionState=r.Disconnected,this.handshakeRejecter&&this.handshakeRejecter(t),Object.keys(n).forEach((function(e){(0,n[e])(null,t||new Error("Invocation canceled due to connection being closed."))})),this.cleanupTimeout(),this.cleanupPingTimer(),this.closedCallbacks.forEach((function(n){return n.apply(e,[t])}))},t.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},t.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},t.prototype.createInvocation=function(t,e,n){if(n)return{arguments:e,target:t,type:i.MessageType.Invocation};var r=this.id;return this.id++,{arguments:e,invocationId:r.toString(),target:t,type:i.MessageType.Invocation}},t.prototype.createStreamInvocation=function(t,e){var n=this.id;return this.id++,{arguments:e,invocationId:n.toString(),target:t,type:i.MessageType.StreamInvocation}},t.prototype.createCancelInvocation=function(t){return{invocationId:t,type:i.MessageType.CancelInvocation}},t}()},function(t,e,n){n.r(e),n.d(e,"HandshakeProtocol",(function(){return i}));var r=n(12),o=n(13),i=function(){function t(){}return t.prototype.writeHandshakeRequest=function(t){return r.TextMessageFormat.write(JSON.stringify(t))},t.prototype.parseHandshakeResponse=function(t){var e,n;if(Object(o.isArrayBuffer)(t)||"undefined"!=typeof Buffer&&t instanceof Buffer){var i=new Uint8Array(t);if(-1===(a=i.indexOf(r.TextMessageFormat.RecordSeparatorCode)))throw new Error("Message is incomplete.");var s=a+1;e=String.fromCharCode.apply(null,i.slice(0,s)),n=i.byteLength>s?i.slice(s).buffer:null}else{var a,c=t;if(-1===(a=c.indexOf(r.TextMessageFormat.RecordSeparator)))throw new Error("Message is incomplete.");s=a+1,e=c.substring(0,s),n=c.length>s?c.substring(s):null}var u=r.TextMessageFormat.parse(e),l=JSON.parse(u[0]);if(l.type)throw new Error("Expected a handshake response from the server.");return[n,l]},t}()},function(t,e,n){n.r(e),n.d(e,"TextMessageFormat",(function(){return r}));var r=function(){function t(){}return t.write=function(e){return""+e+t.RecordSeparator},t.parse=function(e){if(e[e.length-1]!==t.RecordSeparator)throw new Error("Message is incomplete.");var n=e.split(t.RecordSeparator);return n.pop(),n},t.RecordSeparatorCode=30,t.RecordSeparator=String.fromCharCode(t.RecordSeparatorCode),t}()},function(t,e,n){n.r(e),n.d(e,"Arg",(function(){return s})),n.d(e,"getDataDetail",(function(){return a})),n.d(e,"formatArrayBuffer",(function(){return c})),n.d(e,"isArrayBuffer",(function(){return u})),n.d(e,"sendMessage",(function(){return l})),n.d(e,"createLogger",(function(){return p})),n.d(e,"Subject",(function(){return f})),n.d(e,"SubjectSubscription",(function(){return h})),n.d(e,"ConsoleLogger",(function(){return d}));var r=n(9),o=n(14),i=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},s=function(){function t(){}return t.isRequired=function(t,e){if(null==t)throw new Error("The '"+e+"' argument is required.")},t.isIn=function(t,e,n){if(!(t in e))throw new Error("Unknown "+n+" value: "+t+".")},t}();function a(t,e){var n="";return u(t)?(n="Binary data of length "+t.byteLength,e&&(n+=". Content: '"+c(t)+"'")):"string"==typeof t&&(n="String data of length "+t.length,e&&(n+=". Content: '"+t+"'")),n}function c(t){var e=new Uint8Array(t),n="";return e.forEach((function(t){n+="0x"+(t<16?"0":"")+t.toString(16)+" "})),n.substr(0,n.length-1)}function u(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function l(t,e,n,o,s,c,l){return p=this,f=void 0,d=function(){var p,f,h,d,g;return i(this,(function(i){switch(i.label){case 0:return s?[4,s()]:[3,2];case 1:(h=i.sent())&&((p={}).Authorization="Bearer "+h,f=p),i.label=2;case 2:return t.log(r.LogLevel.Trace,"("+e+" transport) sending data. "+a(c,l)+"."),d=u(c)?"arraybuffer":"text",[4,n.post(o,{content:c,headers:f,responseType:d})];case 3:return g=i.sent(),t.log(r.LogLevel.Trace,"("+e+" transport) request complete. Response status: "+g.statusCode+"."),[2]}}))},new((h=void 0)||(h=Promise))((function(t,e){function n(t){try{o(d.next(t))}catch(t){e(t)}}function r(t){try{o(d.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new h((function(t){t(e.value)})).then(n,r)}o((d=d.apply(p,f||[])).next())}));var p,f,h,d}function p(t){return void 0===t?new d(r.LogLevel.Information):null===t?o.NullLogger.instance:t.log?t:new d(t)}var f=function(){function t(){this.observers=[]}return t.prototype.next=function(t){for(var e=0,n=this.observers;e<n.length;e++)n[e].next(t)},t.prototype.error=function(t){for(var e=0,n=this.observers;e<n.length;e++){var r=n[e];r.error&&r.error(t)}},t.prototype.complete=function(){for(var t=0,e=this.observers;t<e.length;t++){var n=e[t];n.complete&&n.complete()}},t.prototype.subscribe=function(t){return this.observers.push(t),new h(this,t)},t}(),h=function(){function t(t,e){this.subject=t,this.observer=e}return t.prototype.dispose=function(){var t=this.subject.observers.indexOf(this.observer);t>-1&&this.subject.observers.splice(t,1),0===this.subject.observers.length&&this.subject.cancelCallback&&this.subject.cancelCallback().catch((function(t){}))},t}(),d=function(){function t(t){this.minimumLogLevel=t}return t.prototype.log=function(t,e){if(t>=this.minimumLogLevel)switch(t){case r.LogLevel.Critical:case r.LogLevel.Error:console.error("["+(new Date).toISOString()+"] "+r.LogLevel[t]+": "+e);break;case r.LogLevel.Warning:console.warn("["+(new Date).toISOString()+"] "+r.LogLevel[t]+": "+e);break;case r.LogLevel.Information:console.info("["+(new Date).toISOString()+"] "+r.LogLevel[t]+": "+e);break;default:console.log("["+(new Date).toISOString()+"] "+r.LogLevel[t]+": "+e)}},t}()},function(t,e,n){n.r(e),n.d(e,"NullLogger",(function(){return r}));var r=function(){function t(){}return t.prototype.log=function(t,e){},t.instance=new t,t}()},function(t,e,n){var r;n.r(e),n.d(e,"MessageType",(function(){return r})),function(t){t[t.Invocation=1]="Invocation",t[t.StreamItem=2]="StreamItem",t[t.Completion=3]="Completion",t[t.StreamInvocation=4]="StreamInvocation",t[t.CancelInvocation=5]="CancelInvocation",t[t.Ping=6]="Ping",t[t.Close=7]="Close"}(r||(r={}))},function(t,e,n){n.r(e),n.d(e,"HubConnectionBuilder",(function(){return c}));var r=n(17),o=n(10),i=n(23),s=n(14),a=n(13),c=function(){function t(){}return t.prototype.configureLogging=function(t){return a.Arg.isRequired(t,"logging"),void 0!==t.log?this.logger=t:this.logger=new a.ConsoleLogger(t),this},t.prototype.withUrl=function(t,e){return a.Arg.isRequired(t,"url"),this.url=t,this.httpConnectionOptions="object"==typeof e?e:{transport:e},this},t.prototype.withHubProtocol=function(t){return a.Arg.isRequired(t,"protocol"),this.protocol=t,this},t.prototype.build=function(){var t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var e=new r.HttpConnection(this.url,t);return o.HubConnection.create(e,this.logger||s.NullLogger.instance,this.protocol||new i.JsonHubProtocol)},t}()},function(t,e,n){n.r(e),n.d(e,"HttpConnection",(function(){return g}));var r=n(6),o=n(9),i=n(18),s=n(19),a=n(21),c=n(13),u=n(22),l=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(s,a)}c((r=r.apply(t,e||[])).next())}))},p=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},f=null,h=null;if("undefined"==typeof window){var d=V;f=d("ws"),h=d("eventsource")}var g=function(){function t(t,e){void 0===e&&(e={}),this.features={},c.Arg.isRequired(t,"url"),this.logger=Object(c.createLogger)(e.logger),this.baseUrl=this.resolveUrl(t),(e=e||{}).logMessageContent=e.logMessageContent||!1;var n="undefined"==typeof window;n||"undefined"==typeof WebSocket||e.WebSocket?n&&!e.WebSocket&&f&&(e.WebSocket=f):e.WebSocket=WebSocket,n||"undefined"==typeof EventSource||e.EventSource?n&&!e.EventSource&&void 0!==h&&(e.EventSource=h):e.EventSource=EventSource,this.httpClient=e.httpClient||new r.DefaultHttpClient(this.logger),this.connectionState=2,this.options=e,this.onreceive=null,this.onclose=null}return t.prototype.start=function(t){return t=t||i.TransferFormat.Binary,c.Arg.isIn(t,i.TransferFormat,"transferFormat"),this.logger.log(o.LogLevel.Debug,"Starting connection with transfer format '"+i.TransferFormat[t]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(t),this.startPromise)},t.prototype.send=function(t){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(t)},t.prototype.stop=function(t){return l(this,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:this.connectionState=2,this.stopError=t,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.startPromise];case 2:case 3:return e.sent(),[3,4];case 4:return this.transport?[4,this.transport.stop()]:[3,6];case 5:e.sent(),this.transport=void 0,e.label=6;case 6:return[2]}}))}))},t.prototype.startInternal=function(t){return l(this,void 0,void 0,(function(){var e,n,r,a,c,u,l,f=this;return p(this,(function(h){switch(h.label){case 0:e=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,h.label=1;case 1:return h.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==i.HttpTransportType.WebSockets?[3,3]:(this.transport=this.constructTransport(i.HttpTransportType.WebSockets),[4,this.transport.connect(e,t)]):[3,5];case 2:return h.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:n=null,r=0,a=function(){var t;return p(this,(function(o){switch(o.label){case 0:return[4,c.getNegotiationResponse(e)];case 1:if(n=o.sent(),2===c.connectionState)return[2,{value:void 0}];if(n.error)throw Error(n.error);if(n.ProtocolVersion)throw Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return n.url&&(e=n.url),n.accessToken&&(t=n.accessToken,c.accessTokenFactory=function(){return t}),r++,[2]}}))},c=this,h.label=6;case 6:return[5,a()];case 7:if("object"==typeof(u=h.sent()))return[2,u.value];h.label=8;case 8:if(n.url&&r<100)return[3,6];h.label=9;case 9:if(100===r&&n.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(e,this.options.transport,n,t)];case 10:h.sent(),h.label=11;case 11:return this.transport instanceof s.LongPollingTransport&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(t){return f.stopConnection(t)},this.changeState(0,1),[3,13];case 12:throw l=h.sent(),this.logger.log(o.LogLevel.Error,"Failed to start the connection: "+l),this.connectionState=2,this.transport=void 0,l;case 13:return[2]}}))}))},t.prototype.getNegotiationResponse=function(t){return l(this,void 0,void 0,(function(){var e,n,r,i,s,a;return p(this,(function(c){switch(c.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=c.sent())&&((e={}).Authorization="Bearer "+r,n=e),c.label=2;case 2:i=this.resolveNegotiateUrl(t),this.logger.log(o.LogLevel.Debug,"Sending negotiation request: "+i+"."),c.label=3;case 3:return c.trys.push([3,5,,6]),[4,this.httpClient.post(i,{content:"",headers:n})];case 4:if(200!==(s=c.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+s.statusCode);return[2,JSON.parse(s.content)];case 5:throw a=c.sent(),this.logger.log(o.LogLevel.Error,"Failed to complete negotiation with the server: "+a),a;case 6:return[2]}}))}))},t.prototype.createConnectUrl=function(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+"id="+e:t},t.prototype.createTransport=function(t,e,n,r){return l(this,void 0,void 0,(function(){var s,a,c,u,l,f,h;return p(this,(function(p){switch(p.label){case 0:return s=this.createConnectUrl(t,n.connectionId),this.isITransport(e)?(this.logger.log(o.LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=e,[4,this.transport.connect(s,r)]):[3,2];case 1:return p.sent(),this.changeState(0,1),[2];case 2:a=n.availableTransports||[],c=0,u=a,p.label=3;case 3:return c<u.length?(l=u[c],this.connectionState=0,"number"!=typeof(f=this.resolveTransport(l,e,r))?[3,8]:(this.transport=this.constructTransport(f),n.connectionId?[3,5]:[4,this.getNegotiationResponse(t)])):[3,9];case 4:n=p.sent(),s=this.createConnectUrl(t,n.connectionId),p.label=5;case 5:return p.trys.push([5,7,,8]),[4,this.transport.connect(s,r)];case 6:return p.sent(),this.changeState(0,1),[2];case 7:return h=p.sent(),this.logger.log(o.LogLevel.Error,"Failed to start the transport '"+i.HttpTransportType[f]+"': "+h),this.connectionState=2,n.connectionId=void 0,[3,8];case 8:return c++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}}))}))},t.prototype.constructTransport=function(t){switch(t){case i.HttpTransportType.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new u.WebSocketTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case i.HttpTransportType.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new a.ServerSentEventsTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case i.HttpTransportType.LongPolling:return new s.LongPollingTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+t+".")}},t.prototype.resolveTransport=function(t,e,n){var r=i.HttpTransportType[t.transport];if(null==r)this.logger.log(o.LogLevel.Debug,"Skipping transport '"+t.transport+"' because it is not supported by this client.");else{var s=t.transferFormats.map((function(t){return i.TransferFormat[t]}));if(function(t,e){return!t||0!=(e&t)}(e,r))if(s.indexOf(n)>=0){if((r!==i.HttpTransportType.WebSockets||this.options.WebSocket)&&(r!==i.HttpTransportType.ServerSentEvents||this.options.EventSource))return this.logger.log(o.LogLevel.Debug,"Selecting transport '"+i.HttpTransportType[r]+"'."),r;this.logger.log(o.LogLevel.Debug,"Skipping transport '"+i.HttpTransportType[r]+"' because it is not supported in your environment.'")}else this.logger.log(o.LogLevel.Debug,"Skipping transport '"+i.HttpTransportType[r]+"' because it does not support the requested transfer format '"+i.TransferFormat[n]+"'.");else this.logger.log(o.LogLevel.Debug,"Skipping transport '"+i.HttpTransportType[r]+"' because it was disabled by the client.")}return null},t.prototype.isITransport=function(t){return t&&"object"==typeof t&&"connect"in t},t.prototype.changeState=function(t,e){return this.connectionState===t&&(this.connectionState=e,!0)},t.prototype.stopConnection=function(t){this.transport=void 0,(t=this.stopError||t)?this.logger.log(o.LogLevel.Error,"Connection disconnected with error '"+t+"'."):this.logger.log(o.LogLevel.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(t)},t.prototype.resolveUrl=function(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+t+"'.");var e=window.document.createElement("a");return e.href=t,this.logger.log(o.LogLevel.Information,"Normalizing '"+t+"' to '"+e.href+"'."),e.href},t.prototype.resolveNegotiateUrl=function(t){var e=t.indexOf("?"),n=t.substring(0,-1===e?t.length:e);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",n+=-1===e?"":t.substring(e)},t}()},function(t,e,n){var r,o;n.r(e),n.d(e,"HttpTransportType",(function(){return r})),n.d(e,"TransferFormat",(function(){return o})),function(t){t[t.None=0]="None",t[t.WebSockets=1]="WebSockets",t[t.ServerSentEvents=2]="ServerSentEvents",t[t.LongPolling=4]="LongPolling"}(r||(r={})),function(t){t[t.Text=1]="Text",t[t.Binary=2]="Binary"}(o||(o={}))},function(t,e,n){n.r(e),n.d(e,"LongPollingTransport",(function(){return l}));var r=n(20),o=n(4),i=n(9),s=n(18),a=n(13),c=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(s,a)}c((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},l=function(){function t(t,e,n,o){this.httpClient=t,this.accessTokenFactory=e,this.logger=n,this.pollAbort=new r.AbortController,this.logMessageContent=o,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(t.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),t.prototype.connect=function(t,e){return c(this,void 0,void 0,(function(){var n,r,c,l;return u(this,(function(u){switch(u.label){case 0:if(a.Arg.isRequired(t,"url"),a.Arg.isRequired(e,"transferFormat"),a.Arg.isIn(e,s.TransferFormat,"transferFormat"),this.url=t,this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Connecting."),e===s.TransferFormat.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return n={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},e===s.TransferFormat.Binary&&(n.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return r=u.sent(),this.updateHeaderToken(n,r),c=t+"&_="+Date.now(),this.logger.log(i.LogLevel.Trace,"(LongPolling transport) polling: "+c+"."),[4,this.httpClient.get(c,n)];case 2:return 200!==(l=u.sent()).statusCode?(this.logger.log(i.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+l.statusCode+"."),this.closeError=new o.HttpError(l.statusText||"",l.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,n),[2]}}))}))},t.prototype.getAccessToken=function(){return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,null]}}))}))},t.prototype.updateHeaderToken=function(t,e){t.headers||(t.headers={}),e?t.headers.Authorization="Bearer "+e:t.headers.Authorization&&delete t.headers.Authorization},t.prototype.poll=function(t,e){return c(this,void 0,void 0,(function(){var n,r,s,c;return u(this,(function(u){switch(u.label){case 0:u.trys.push([0,,8,9]),u.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:n=u.sent(),this.updateHeaderToken(e,n),u.label=3;case 3:return u.trys.push([3,5,,6]),r=t+"&_="+Date.now(),this.logger.log(i.LogLevel.Trace,"(LongPolling transport) polling: "+r+"."),[4,this.httpClient.get(r,e)];case 4:return 204===(s=u.sent()).statusCode?(this.logger.log(i.LogLevel.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==s.statusCode?(this.logger.log(i.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+s.statusCode+"."),this.closeError=new o.HttpError(s.statusText||"",s.statusCode),this.running=!1):s.content?(this.logger.log(i.LogLevel.Trace,"(LongPolling transport) data received. "+Object(a.getDataDetail)(s.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(s.content)):this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return c=u.sent(),this.running?c instanceof o.TimeoutError?this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=c,this.running=!1):this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Poll errored after shutdown: "+c.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}}))}))},t.prototype.send=function(t){return c(this,void 0,void 0,(function(){return u(this,(function(e){return this.running?[2,Object(a.sendMessage)(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]}))}))},t.prototype.stop=function(){return c(this,void 0,void 0,(function(){var t,e;return u(this,(function(n){switch(n.label){case 0:this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),n.label=1;case 1:return n.trys.push([1,,5,6]),[4,this.receiving];case 2:return n.sent(),this.logger.log(i.LogLevel.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),t={headers:{}},[4,this.getAccessToken()];case 3:return e=n.sent(),this.updateHeaderToken(t,e),[4,this.httpClient.delete(this.url,t)];case 4:return n.sent(),this.logger.log(i.LogLevel.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}}))}))},t.prototype.raiseOnClose=function(){if(this.onclose){var t="(LongPolling transport) Firing onclose event.";this.closeError&&(t+=" Error: "+this.closeError),this.logger.log(i.LogLevel.Trace,t),this.onclose(this.closeError)}},t}()},function(t,e,n){n.r(e),n.d(e,"AbortController",(function(){return r}));var r=function(){function t(){this.isAborted=!1,this.onabort=null}return t.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(t.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),t}()},function(t,e,n){n.r(e),n.d(e,"ServerSentEventsTransport",(function(){return c}));var r=n(9),o=n(18),i=n(13),s=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(s,a)}c((r=r.apply(t,e||[])).next())}))},a=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},c=function(){function t(t,e,n,r,o){this.httpClient=t,this.accessTokenFactory=e,this.logger=n,this.logMessageContent=r,this.eventSourceConstructor=o,this.onreceive=null,this.onclose=null}return t.prototype.connect=function(t,e){return s(this,void 0,void 0,(function(){var n,s=this;return a(this,(function(a){switch(a.label){case 0:return i.Arg.isRequired(t,"url"),i.Arg.isRequired(e,"transferFormat"),i.Arg.isIn(e,o.TransferFormat,"transferFormat"),this.logger.log(r.LogLevel.Trace,"(SSE transport) Connecting."),this.url=t,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=a.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),a.label=2;case 2:return[2,new Promise((function(n,a){var c=!1;if(e===o.TransferFormat.Text){var u;if("undefined"!=typeof window)u=new s.eventSourceConstructor(t,{withCredentials:!0});else{var l=s.httpClient.getCookieString(t);u=new s.eventSourceConstructor(t,{withCredentials:!0,headers:{Cookie:l}})}try{u.onmessage=function(t){if(s.onreceive)try{s.logger.log(r.LogLevel.Trace,"(SSE transport) data received. "+Object(i.getDataDetail)(t.data,s.logMessageContent)+"."),s.onreceive(t.data)}catch(t){return void s.close(t)}},u.onerror=function(t){var e=new Error(t.data||"Error occurred");c?s.close(e):a(e)},u.onopen=function(){s.logger.log(r.LogLevel.Information,"SSE connected to "+s.url),s.eventSource=u,c=!0,n()}}catch(t){return void a(t)}}else a(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))]}}))}))},t.prototype.send=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return this.eventSource?[2,Object(i.sendMessage)(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]}))}))},t.prototype.stop=function(){return this.close(),Promise.resolve()},t.prototype.close=function(t){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(t))},t}()},function(t,e,n){n.r(e),n.d(e,"WebSocketTransport",(function(){return a}));var r=n(9),o=n(18),i=n(13),s=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},a=function(){function t(t,e,n,r,o){this.logger=n,this.accessTokenFactory=e,this.logMessageContent=r,this.webSocketConstructor=o,this.httpClient=t,this.onreceive=null,this.onclose=null}return t.prototype.connect=function(t,e){return n=this,a=void 0,u=function(){var n,a=this;return s(this,(function(s){switch(s.label){case 0:return i.Arg.isRequired(t,"url"),i.Arg.isRequired(e,"transferFormat"),i.Arg.isIn(e,o.TransferFormat,"transferFormat"),this.logger.log(r.LogLevel.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=s.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),s.label=2;case 2:return[2,new Promise((function(n,s){var c;t=t.replace(/^http/,"ws");var u=a.httpClient.getCookieString(t);"undefined"==typeof window&&u&&(c=new a.webSocketConstructor(t,void 0,{headers:{Cookie:""+u}})),c||(c=new a.webSocketConstructor(t)),e===o.TransferFormat.Binary&&(c.binaryType="arraybuffer"),c.onopen=function(e){a.logger.log(r.LogLevel.Information,"WebSocket connected to "+t+"."),a.webSocket=c,n()},c.onerror=function(t){var e=null;"undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent&&(e=t.error),s(e)},c.onmessage=function(t){a.logger.log(r.LogLevel.Trace,"(WebSockets transport) data received. "+Object(i.getDataDetail)(t.data,a.logMessageContent)+"."),a.onreceive&&a.onreceive(t.data)},c.onclose=function(t){return a.close(t)}}))]}}))},new((c=void 0)||(c=Promise))((function(t,e){function r(t){try{i(u.next(t))}catch(t){e(t)}}function o(t){try{i(u.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new c((function(t){t(e.value)})).then(r,o)}i((u=u.apply(n,a||[])).next())}));var n,a,c,u},t.prototype.send=function(t){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(r.LogLevel.Trace,"(WebSockets transport) sending data. "+Object(i.getDataDetail)(t,this.logMessageContent)+"."),this.webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},t.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},t.prototype.close=function(t){this.logger.log(r.LogLevel.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!t||!1!==t.wasClean&&1e3===t.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+t.code+" ("+t.reason+").")))},t}()},function(t,e,n){n.r(e),n.d(e,"JsonHubProtocol",(function(){return c}));var r=n(15),o=n(9),i=n(18),s=n(14),a=n(12),c=function(){function t(){this.name="json",this.version=1,this.transferFormat=i.TransferFormat.Text}return t.prototype.parseMessages=function(t,e){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===e&&(e=s.NullLogger.instance);for(var n=[],i=0,c=a.TextMessageFormat.parse(t);i<c.length;i++){var u=c[i],l=JSON.parse(u);if("number"!=typeof l.type)throw new Error("Invalid payload.");switch(l.type){case r.MessageType.Invocation:this.isInvocationMessage(l);break;case r.MessageType.StreamItem:this.isStreamItemMessage(l);break;case r.MessageType.Completion:this.isCompletionMessage(l);break;case r.MessageType.Ping:case r.MessageType.Close:break;default:e.log(o.LogLevel.Information,"Unknown message type '"+l.type+"' ignored.");continue}n.push(l)}return n},t.prototype.writeMessage=function(t){return a.TextMessageFormat.write(JSON.stringify(t))},t.prototype.isInvocationMessage=function(t){this.assertNotEmptyString(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this.assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")},t.prototype.isStreamItemMessage=function(t){if(this.assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")},t.prototype.isCompletionMessage=function(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this.assertNotEmptyString(t.error,"Invalid payload for Completion message."),this.assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")},t.prototype.assertNotEmptyString=function(t,e){if("string"!=typeof t||""===t)throw new Error(e)},t}()}])},t.exports=n()}(Y={exports:{}},Y.exports),Y.exports),tt=(Q=Z)&&Q.__esModule&&Object.prototype.hasOwnProperty.call(Q,"default")?Q.default:Q;function et(t){return`${t.sid}-${t.sender}`}function nt(t,e){return fetch("https://duel-pig.azurewebsites.net/api/"+t,{method:"POST",headers:{"Content-Type":"application/json","x-uid":et(e)},body:JSON.stringify(e)}).catch(console.error)}function rt(t,e,n){const r=t.slice();return r[7]=e[n],r}function ot(t){let e,n,r,o=[3,5],i=[];for(let e=0;e<2;e+=1)i[e]=it(rt(t,o,e));return{c(){e=f("select");for(let t=0;t<2;t+=1)i[t].c();b(e,"class","svelte-1h9tyuk"),void 0===t[2]&&A(()=>t[5].call(e))},m(o,s){u(o,e,s);for(let t=0;t<2;t+=1)i[t].m(e,null);S(e,t[2]),n||(r=v(e,"change",t[5]),n=!0)},p(t,n){4&n&&S(e,t[2])},d(t){t&&l(e),p(i,t),n=!1,r()}}}function it(e){let n,r,o,i;return{c(){n=f("option"),r=h("Best of "),o=h(e[7]),n.__value=i=e[7],n.value=n.__value,b(n,"class","svelte-1h9tyuk")},m(t,e){u(t,n,e),c(n,r),c(n,o)},p:t,d(t){t&&l(n)}}}function st(e){let n,r,i,s,a,p,h,g,m=!e[0]&&ot(e);return{c(){n=f("div"),r=f("form"),i=f("input"),s=d(),m&&m.c(),a=d(),p=f("button"),p.textContent="Go",b(i,"type","text"),b(i,"name","nick"),b(i,"placeholder","nick"),b(i,"class","svelte-1h9tyuk"),b(p,"type","submit"),b(p,"class","svelte-1h9tyuk"),b(r,"class","options svelte-1h9tyuk"),b(n,"class","deck svelte-1h9tyuk")},m(t,o){u(t,n,o),c(n,r),c(r,i),w(i,e[1]),c(r,s),m&&m.m(r,null),c(r,a),c(r,p),h||(g=[v(i,"input",e[4]),v(r,"submit",y(e[3]))],h=!0)},p(t,[e]){2&e&&i.value!==t[1]&&w(i,t[1]),t[0]?m&&(m.d(1),m=null):m?m.p(t,e):(m=ot(t),m.c(),m.m(r,a))},i:t,o:t,d(t){t&&l(n),m&&m.d(),h=!1,o(g)}}}function at(t,e,n){let{sid:r=null}=e;const o=L();let i=localStorage.getItem("nick"),s=+localStorage.getItem("bo")||3;return t.$$set=t=>{"sid"in t&&n(0,r=t.sid)},[r,i,s,function(){localStorage.setItem("nick",i),localStorage.setItem("bo",s);const t={bo:s,sid:r||Math.random().toString(36).substring(2)};var e;return(e=t).bo&&e.sid&&(window.location.hash=`${e.bo}-${e.sid}`),o("next",t),!1},function(){i=this.value,n(1,i)},function(){s=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(2,s)}]}class ct extends G{constructor(t){super(),X(this,t,at,st,s,{sid:0})}}function ut(t,e,n){const r=t.slice();return r[9]=e[n],r}function lt(t){let e,n,r,o,i,s,a=t[6](t[1][t[9]].by)+"";return{c(){e=f("span"),n=h(a),o=d(),i=f("span"),b(e,"class",r="party "+t[1][t[9]].by+" svelte-41ksc6"),b(i,"class",s="action "+t[1][t[9]].action+" svelte-41ksc6")},m(t,r){u(t,e,r),c(e,n),u(t,o,r),u(t,i,r)},p(t,o){3&o&&a!==(a=t[6](t[1][t[9]].by)+"")&&m(n,a),3&o&&r!==(r="party "+t[1][t[9]].by+" svelte-41ksc6")&&b(e,"class",r),3&o&&s!==(s="action "+t[1][t[9]].action+" svelte-41ksc6")&&b(i,"class",s)},d(t){t&&l(e),t&&l(o),t&&l(i)}}}function pt(t){let e,n,r,o,i,s,a,p,h,g,y,m,w=t[1][t[9]]&&lt(t);function S(...e){return t[8](t[9],...e)}return{c(){e=f("li"),n=f("button"),w&&w.c(),r=d(),o=f("img"),a=d(),p=f("span"),g=d(),o.src!==(i="img/"+t[2]+"/"+t[9]+".jpg")&&b(o,"src",i),b(o,"alt",s=t[9]),b(o,"class","svelte-41ksc6"),b(p,"class","overlay svelte-41ksc6"),b(n,"class","tile svelte-41ksc6"),n.disabled=t[3],b(n,"title",h=t[6](t[9])),b(e,"class","svelte-41ksc6")},m(t,i){u(t,e,i),c(e,n),w&&w.m(n,null),c(n,r),c(n,o),c(n,a),c(n,p),c(e,g),y||(m=v(n,"click",S),y=!0)},p(e,a){(t=e)[1][t[9]]?w?w.p(t,a):(w=lt(t),w.c(),w.m(n,r)):w&&(w.d(1),w=null),5&a&&o.src!==(i="img/"+t[2]+"/"+t[9]+".jpg")&&b(o,"src",i),1&a&&s!==(s=t[9])&&b(o,"alt",s),8&a&&(n.disabled=t[3]),1&a&&h!==(h=t[6](t[9]))&&b(n,"title",h)},d(t){t&&l(e),w&&w.d(),y=!1,m()}}}function ft(e){let n,r,o,i,s=e[0],h=[];for(let t=0;t<s.length;t+=1)h[t]=pt(ut(e,s,t));return{c(){n=f("div"),r=f("section"),o=f("ul");for(let t=0;t<h.length;t+=1)h[t].c();b(o,"class","svelte-41ksc6"),b(r,"class","svelte-41ksc6"),b(n,"class",i=a(e[4])+" svelte-41ksc6")},m(t,e){u(t,n,e),c(n,r),c(r,o);for(let t=0;t<h.length;t+=1)h[t].m(o,null)},p(t,[e]){if(111&e){let n;for(s=t[0],n=0;n<s.length;n+=1){const r=ut(t,s,n);h[n]?h[n].p(r,e):(h[n]=pt(r),h[n].c(),h[n].m(o,null))}for(;n<h.length;n+=1)h[n].d(1);h.length=s.length}16&e&&i!==(i=a(t[4])+" svelte-41ksc6")&&b(n,"class",i)},i:t,o:t,d(t){t&&l(n),p(h,t)}}}function ht(t,e,n){let{items:r}=e,{arrangement:o}=e,{img:i}=e,{disabled:s}=e,{cls:a}=e,{labels:c}=e;const u=L();return t.$$set=t=>{"items"in t&&n(0,r=t.items),"arrangement"in t&&n(1,o=t.arrangement),"img"in t&&n(2,i=t.img),"disabled"in t&&n(3,s=t.disabled),"cls"in t&&n(4,a=t.cls),"labels"in t&&n(7,c=t.labels)},[r,o,i,s,a,u,function(t){return c[t]||t||""},c,(t,e)=>u("click",t)]}class dt extends G{constructor(t){super(),X(this,t,ht,ft,s,{items:0,arrangement:1,img:2,disabled:3,cls:4,labels:7})}}var gt={null:"","what-to-do":"Send the link to the other party","us-ban-maps":"ban a map","us-pick-maps":"pick a map","us-ban-champs":"ban a champ","us-pick-champs":"pick a champ","them-ban-maps":"wait for opponent map ban","them-pick-maps":"wait for opponent map pick","them-ban-champs":"wait for opponent champ ban","them-pick-champs":"wait for opponent champ pick","null-null-done":"gl & hf","undefined-undefined-undefined":" ",awoken:"Awoken",blood_covenant:"Blood Covenant",blood_run:"Blood Run",burial_chamber:"Burial Chamber",church:"Church of Azathoth",corrupted_keep:"Corrupted Keep",deep_embrace:"Deep embrace",lockbox:"Lockbox",longest_yard:"Longest Yard",ruins_of_sarnath:"Ruins of Sarnath",tempest_shrine:"Tempest Shrine",the_molten_falls:"Molten Falls",tower_of_koth:"Tower of Koth",vale_of_pnath:"Vale of Pnath",anarki:"Anarki",athena:"Athena",bj:"BJ Blazkowicz",clutch:"Clutch",death_knight:"Death Knight",doom:"DOOM Slayer",eisen:"Eisen",galena:"Galena",keel:"Keel",nyx:"Nyx",ranger:"Ranger",scalebearer:"Scalebearer",slash:"Slash",sorlag:"Sorlag",strogg:"Strogg & Peeker",visor:"Visor"};const vt="toss",yt="maps",bt="champs",mt="done",wt="ban",St="pick";const kt=[];function Tt(e,n=t){let r;const o=[];function i(t){if(s(e,t)&&(e=t,r)){const t=!kt.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),kt.push(n,e)}if(t){for(let t=0;t<kt.length;t+=2)kt[t][0](kt[t+1]);kt.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(s,a=t){const c=[s,a];return o.push(c),1===o.length&&(r=n(i)||t),s(e),()=>{const t=o.indexOf(c);-1!==t&&o.splice(t,1),0===o.length&&(r(),r=null)}}}}const Ct={subscribe:Tt(null,(function(t){return t({maps:["awoken","blood_covenant","blood_run","corrupted_keep","deep_embrace","exile","ruins_of_sarnath","the_molten_falls","tower_of_koth","vale_of_pnath"],champs:["anarki","athena","bj","clutch","death_knight","doom","eisen","galena","keel","nyx","ranger","scalebearer","slash","sorlag","strogg","visor"]}),function(){}})).subscribe};function Lt(t){let e,n,r,o,i,s,a,p,g,v=t[9](t[2].by+"-"+t[2].action+"-"+t[2].state)+"";return s=new dt({props:{cls:t[2].state+" "+t[2].action,labels:t[1],items:t[4],arrangement:t[2].maps,disabled:t[6],img:"maps"}}),s.$on("click",t[13]),p=new dt({props:{cls:t[2].state+" "+t[2].action,labels:t[1],items:t[5],arrangement:t[2].champs,disabled:t[7],img:"champs"}}),p.$on("click",t[14]),{c(){e=f("header"),n=f("span"),r=h(v),o=d(),i=f("div"),B(s.$$.fragment),a=d(),B(p.$$.fragment),b(n,"class","hints svelte-elqxl7"),b(e,"class","svelte-elqxl7"),b(i,"class","deck svelte-elqxl7")},m(t,l){u(t,e,l),c(e,n),c(n,r),u(t,o,l),u(t,i,l),J(s,i,null),c(i,a),J(p,i,null),g=!0},p(t,e){(!g||4&e)&&v!==(v=t[9](t[2].by+"-"+t[2].action+"-"+t[2].state)+"")&&m(r,v);const n={};4&e&&(n.cls=t[2].state+" "+t[2].action),2&e&&(n.labels=t[1]),16&e&&(n.items=t[4]),4&e&&(n.arrangement=t[2].maps),64&e&&(n.disabled=t[6]),s.$set(n);const o={};4&e&&(o.cls=t[2].state+" "+t[2].action),2&e&&(o.labels=t[1]),32&e&&(o.items=t[5]),4&e&&(o.arrangement=t[2].champs),128&e&&(o.disabled=t[7]),p.$set(o)},i(t){g||(q(s.$$.fragment,t),q(p.$$.fragment,t),g=!0)},o(t){U(s.$$.fragment,t),U(p.$$.fragment,t),g=!1},d(t){t&&l(e),t&&l(o),t&&l(i),z(s),z(p)}}}function Et(e){let n,r,o,i=(e[0]||"Connecting...")+"";return{c(){n=f("div"),r=f("h1"),o=h(i),b(n,"class","deck-centered")},m(t,e){u(t,n,e),c(n,r),c(r,o)},p(t,e){1&e&&i!==(i=(t[0]||"Connecting...")+"")&&m(o,i)},i:t,o:t,d(t){t&&l(n)}}}function _t(t){let e,n,r,o;const i=[Et,Lt],s=[];function a(t,e){return t[0]||!t[3]?0:1}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=g()},m(t,n){s[e].m(t,n),u(t,r,n),o=!0},p(t,[o]){let c=e;e=a(t),e===c?s[e].p(t,o):(N(),U(s[c],1,1,()=>{s[c]=null}),D(),n=s[e],n||(n=s[e]=i[e](t),n.c()),q(n,1),n.m(r.parentNode,r))},i(t){o||(q(n),o=!0)},o(t){U(n),o=!1},d(t){s[e].d(t),t&&l(r)}}}function xt(t,e,n){let{bo:r}=e,{sid:o}=e,{sender:i=localStorage.getItem("nick")}=e,{error:s=null}=e;const a={...gt,us:i};let c,u=()=>{},l={},p=!1,f=["us","them"],h=[],d=[];function g(t){v(t,()=>nt("messages",{sender:i,data:t,sid:r+o}))}function v(t,e=null){l.maps[t]||l.champs[t]||(e&&e(),n(2,l=c.next(t).value||l),l.state===bt&&n(4,h=m(h,l.maps)),l.state===mt&&n(5,d=m(d,l.champs)))}function y(t){!function(t){u(),u=Ct.subscribe(e=>{if(e){n(4,h=e.maps),n(5,d=e.champs);try{c=function*(t,e,n,r,o){if(2!==t.length)throw"2 player system only";if(-1==[3,5].indexOf(e))throw"don't know how to play best of "+e;const i={maps:{},champs:{},state:null,action:null,by:null};i.state=vt;let s=o;i.state=yt,i.action=wt,i.by=t[s%t.length];let a,c=1;do{a=yield i}while(l(a));i.action=p();do{a=yield i}while(f(a));return i.action=null,i.by=null,i;function u(){const t=Object.values(i.maps).filter(t=>t.action==wt).length>=n.length-e;return(c+1)%4<2||t?St:wt}function l(t){return h(i.maps,e,u,n,t,"invalid map",bt)}function p(){return(c-e+1)%3?St:wt}function f(t){return h(i.champs,2*e,p,r,t,"invalid champ",mt)}function h(e,n,r,o,a,u,l){if(-1===o.indexOf(a))throw u;e[a]={action:r(c),by:t[s++%t.length],order:c++};const p=Object.values(e).filter(t=>t.action==St).length>=n;return i.action=r(c),i.by=t[s%t.length],p&&(i.state=l),!p}}(f,r,h,d,t),n(2,l=c.next().value)}catch(t){n(0,s=t)}}})}(t.toss==et({sender:i,sid:r+o})?0:1),n(3,p=!0)}function b(t){t.sender!==i&&(v(t.data),n(1,a.them=t.sender,a))}function m(t,e){return t.filter(t=>function(t,e){return t[e]&&t[e].action===St}(e,t)).sort((t,n)=>function(t,e,n){return(t[e]||{order:100}).order-(t[n]||{order:100}).order}(e,t,n))}!function(t){C().$$.on_mount.push(t)}((function(){try{!function(t,e,n){nt("negotiate",t).then(t=>t.json()).then(r=>{const o=(new tt.HubConnectionBuilder).withUrl(r.url,{accessTokenFactory:()=>r.accessToken}).configureLogging(tt.LogLevel.Information).build();return o.on("msg",n),o.on("join",e),o.onclose(()=>nt("leave",t)),o.start()}).then(()=>nt("join",t)).catch(console.error)}({sender:i,sid:r+o},y,b)}catch(t){n(0,s=t)}})),function(t){C().$$.on_destroy.push(t)}(u);let w,S;return t.$$set=t=>{"bo"in t&&n(10,r=t.bo),"sid"in t&&n(11,o=t.sid),"sender"in t&&n(12,i=t.sender),"error"in t&&n(0,s=t.error)},t.$$.update=()=>{4&t.$$.dirty&&n(6,w=l.state!==yt&&l.state!==mt||"them"==l.by),4&t.$$.dirty&&n(7,S=l.state!==bt&&l.state!==mt||"them"==l.by)},[s,a,l,p,h,d,w,S,g,function(t){return a[t]||t||""},r,o,i,t=>g(t.detail),t=>g(t.detail)]}class Pt extends G{constructor(t){super(),X(this,t,xt,_t,s,{bo:10,sid:11,sender:12,error:0})}}const{window:Ht}=W;function It(e){let n;return{c(){n=f("div"),n.innerHTML="<h1>nope</h1>",b(n,"class","deck-centered")},m(t,e){u(t,n,e)},p:t,i:t,o:t,d(t){t&&l(n)}}}function At(t){let n,r,o;const s=[t[0]];var a=t[2][t[1]].component;function c(t){let n={};for(let t=0;t<s.length;t+=1)n=e(n,s[t]);return{props:n}}return a&&(n=new a(c()),n.$on("next",(function(){i(t[2][t[1]].next)&&t[2][t[1]].next.apply(this,arguments)}))),{c(){n&&B(n.$$.fragment),r=g()},m(t,e){n&&J(n,t,e),u(t,r,e),o=!0},p(e,o){t=e;const u=1&o?function(t,e){const n={},r={},o={$$scope:1};let i=t.length;for(;i--;){const s=t[i],a=e[i];if(a){for(const t in s)t in a||(r[t]=1);for(const t in a)o[t]||(n[t]=a[t],o[t]=1);t[i]=a}else for(const t in s)o[t]=1}for(const t in r)t in n||(n[t]=void 0);return n}(s,[(l=t[0],"object"==typeof l&&null!==l?l:{})]):{};var l;if(a!==(a=t[2][t[1]].component)){if(n){N();const t=n;U(t.$$.fragment,1,0,()=>{z(t,1)}),D()}a?(n=new a(c()),n.$on("next",(function(){i(t[2][t[1]].next)&&t[2][t[1]].next.apply(this,arguments)})),B(n.$$.fragment),q(n.$$.fragment,1),J(n,r.parentNode,r)):n=null}else a&&n.$set(u)},i(t){o||(n&&q(n.$$.fragment,t),o=!0)},o(t){n&&U(n.$$.fragment,t),o=!1},d(t){t&&l(r),n&&z(n,t)}}}function Mt(t){let e,n,r,o,i,s;const a=[At,It],c=[];function p(t,e){return t[2][t[1]]?0:1}return e=p(t),n=c[e]=a[e](t),{c(){n.c(),r=g()},m(n,a){c[e].m(n,a),u(n,r,a),o=!0,i||(s=v(Ht,"hashchange",t[3]),i=!0)},p(t,[o]){let i=e;e=p(t),e===i?c[e].p(t,o):(N(),U(c[i],1,1,()=>{c[i]=null}),D(),n=c[e],n||(n=c[e]=a[e](t),n.c()),q(n,1),n.m(r.parentNode,r))},i(t){o||(q(n),o=!0)},o(t){U(n),o=!1},d(t){c[e].d(t),t&&l(r),i=!1,s()}}}function Ot(t,e,n){const r="setup",o="shuffle",i={[r]:{component:ct,next:t=>u(t.detail,o)},[o]:{component:Pt,next:t=>u(t.detail)}};let s,a=localStorage.getItem("nick"),c=(n(0,s=function(){const t=window.location.hash.substr(1).split("-");return 2!==t.length?null:{bo:+t[0],sid:t[1]}}()),s&&a?o:r);function u(t,e){n(0,s=t),n(1,c=e)}return[s,c,i,()=>window.location.reload()]}return new class extends G{constructor(t){super(),X(this,t,Ot,Mt,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
